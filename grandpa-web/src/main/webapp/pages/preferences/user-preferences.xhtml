<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:rich="http://richfaces.org/rich" xmlns:a4j="http://richfaces.org/a4j" template="/WEB-INF/templates/default.xhtml">
	<ui:define name="content">

		<h1 class="w3-text-teal">User Preferences</h1>

		<fieldset class="pc50">
			<legend>Programming</legend>
			<h:panelGroup layout="block" styleClass="frm-line">
				<h:outputLabel value="Programming Theme" />
				<h:selectOneMenu id="usrPrefTheme" value="#{userPreferenceAction.scriptingTheme.value}" immediate="true">
					<f:selectItem itemValue="default" itemLabel="Default" />
					<f:selectItems value="#{userPreferenceAction.themeOpt}" />
					<f:ajax event="change" onevent="changeScriptTheme(this.value)" />
				</h:selectOneMenu>
			</h:panelGroup>

			<h:panelGroup layout="block">
				<a4j:commandButton action="#{userPreferenceAction.savePreferences()}" value="Save" styleClass="primary" render="bmNotify" />
			</h:panelGroup>

			<h:panelGroup id="scriptCodeId" layout="block" styleClass="frm-line">
				<h:outputLabel value="Programming Editor Sample" styleClass="txtop" />
				<h:panelGroup layout="block" styleClass="scripting">
					<h:inputTextarea id="postProcessScript" value="#{userPreferenceAction.codeExample}" rows="6" />
				</h:panelGroup>
			</h:panelGroup>

		</fieldset>


		<script type="text/javascript">
			var scriptEditor = CodeMirror.fromTextArea(document.getElementById('frm:postProcessScript'), {
			    mode: "groovy",
			    theme: "#{userPreferenceAction.scriptingTheme.value}", 
			    lineNumbers: true, 
			    indentWithTabs: true,
			    lineWrapping: true 
			});
			scriptEditor.setSize('100%', 200);
			
			function changeScriptTheme() {
				try {
					var theme = document.getElementById('frm:usrPrefTheme').value;
					// var wdt = document.getElementById('frm:usrPrefWdt').value;
					// var hgt = document.getElementById('frm:usrPrefHgt').value;
					scriptEditor.setOption("theme", theme);
					// scriptEditor.setSize(wdt, hgt);
				} catch(e) {
					alert(e);
				}
			}

			
		</script>

	</ui:define>
</ui:composition>